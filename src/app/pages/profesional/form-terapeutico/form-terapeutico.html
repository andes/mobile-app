<ion-header background="dark" translucent="true">
    <ion-toolbar>
        <ion-back-button slot="start" defaultHref="home" text=""></ion-back-button>
        <ion-title><small>Formulario terap√©utico</small></ion-title>
        <ion-buttons slot="end">
            <ion-menu-button></ion-menu-button>
        </ion-buttons>
    </ion-toolbar>
</ion-header>
<ion-content form-terapeutico>
    <div *ngIf="!filtrados?.length > 0">
        <ion-row justify-content-between class="search-container">
            <ion-col col-10>
                <ion-searchbar [(ngModel)]="nombre" placeholder="Buscar" (ionInput)="busquedaMedicamentos($event)"
                               (ionClear)="onCancel($event)"></ion-searchbar>
                <ion-list>
                    <button ion-item *ngFor="let medicamento of medicamentos" (click)="itemSelected(medicamento)">
                        {{medicamento.descripcion}}
                    </button>
                </ion-list>
            </ion-col>
            <ion-col col-2 align-self-center>
                <button ion-button icon-only class="circular xs outline primary" [disabled]="disableArbol"
                        (click)="arbol()">
                    <ion-icon name="md-list"></ion-icon>
                </button>
            </ion-col>
        </ion-row>
        <ion-list padding>
            <ion-row class="item-container">
                <ion-col col-12>
                    <ion-label class="andes-input-title txt-gris-oscuro ">Especialidad</ion-label>
                    <ion-row>
                        <ion-col col-10 align-self-center>
                            <ion-select class="outline" full interface="popover" [(ngModel)]="especialidadSelected"
                                        (ionChange)="onSelectEspecialidad()">
                                <ion-select-option *ngFor="let especialidad of especialidades" [value]="especialidad">
                                    {{especialidad.descripcion}}
                                </ion-select-option>
                            </ion-select>
                        </ion-col>
                        <ion-col col-2 align-self-center>
                            <button ion-button clear icon-only (click)="limpiarEspecialidad()">
                                <ion-icon ios="ios-close-circle" md="md-close-circle"></ion-icon>
                            </button>
                        </ion-col>
                    </ion-row>
                </ion-col>

            </ion-row>
            <ion-row class="item-container" nowrap justify-content-between align-items-center>
                <ion-col col-6>
                    <ion-label class="andes-input-title txt-gris-oscuro ">Carro Emergencia</ion-label>
                </ion-col>
                <ion-col>
                    <ion-label>NO</ion-label>
                </ion-col>
                <ion-col>
                    <ion-toggle class="outline" full interface="popover" [(ngModel)]="carroSelected"
                                (ionChange)="onSelectCarro()">
                        <ion-item value="true"></ion-item>
                        <ion-item value="false"></ion-item>
                    </ion-toggle>
                </ion-col>
                <ion-col>
                    <ion-label>SI</ion-label>
                </ion-col>
            </ion-row>
            <ion-row class="item-container" justify-content-center align-items-center>
                <ion-col col-4 align-self-center>
                    <ion-label class="andes-input-title txt-gris-oscuro ">Nivel de Complejidad</ion-label>
                </ion-col>
                <ion-col col-8 align-self-center>
                    <ion-row>
                        <ion-col col-10 align-self-center>
                            <ion-select class="outline" full interface="popover" [(ngModel)]="nivelSelected"
                                        (ionChange)="onSelectComplejidad()">
                                <ion-select-option *ngFor="let nivel of niveles" [value]="nivel">
                                    {{nivel}}
                                </ion-select-option>
                            </ion-select>
                        </ion-col>
                        <ion-col col-2 align-self-center>
                            <button ion-button clear icon-only (click)="limpiarNivel()">
                                <ion-icon ios="ios-close-circle" md="md-close-circle"></ion-icon>
                            </button>
                        </ion-col>
                    </ion-row>
                </ion-col>
            </ion-row>

            <!-- Resultados -->
            <div>
                <button class="md rounded block success" (click)="buscar()">Buscar</button>
            </div>
        </ion-list>
    </div>
    <div *ngIf="filtrados?.length > 0" padding>
        <ul class="andes-list">
            <li class="" *ngFor="let filtrado of filtrados" (click)="itemSelected(filtrado)">
                <div class="andes-container">
                    <div class="andes-wraper">
                        <div class="badge primary" *ngIf="filtrado.concepto?.term.split(', ').length >= 2">
                            {{ filtrado.concepto.term.split(', ')[1] }}</div>
                        <h2 class="andes-list-title" *ngIf="filtrado.concepto?.term.split(', ').length >= 1">
                            {{ filtrado.concepto.term.split(', ')[0] }}</h2>
                        <div class="andes-list-content">
                            <span class="andes-list-subtitle"
                                  *ngIf="filtrado.concepto?.term.split(', ').length >= 4">{{ filtrado.concepto.term.split(', ')[3] }}</span>
                            <span class="andes-list-subfix"
                                  *ngIf="filtrado.concepto?.term.split(', ').length >= 3">{{ filtrado.concepto.term.split(', ')[2] }}</span>
                        </div>
                    </div>
                    <ion-icon class="icon-action right xl icon icon-md ion-chevron-forward-outline"
                              name="chevron-forward-outline" role="img" aria-label="arrow forward-outline"
                              ng-reflect-name="chevron-forward-outline"></ion-icon>
                </div>
            </li>
        </ul>
        <!-- Volver -->
        <div>
            <button ion-button icon-only class="md rounded block danger" (click)="volver()">Volver</button>
        </div>
    </div>
</ion-content>